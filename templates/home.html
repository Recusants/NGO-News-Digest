{% extends 'partials/base.html' %}
{% load static %}

{% block title %}NGO News Digest - Home{% endblock %}
{% block content %}
    {% include 'partials/header.html' %}
    {% csrf_token %}
    <section id="home" class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1 class="hero-title">Amplifying <span>Civil Society Impact</span> in Zimbabwe</h1>
                <p class="hero-description">NGO News Digest is dedicated to sharing, amplifying, and celebrating the work of non-governmental organisations across Zimbabwe. We document grassroots impact, showcase development innovation, and connect stakeholders through impactful storytelling.</p>
                
                <div class="hero-subscribe">
                    <h3>Subscribe to Our Newsletter</h3>
                    <div class="subscribe-form" id="heroSubscribeForm">
                        <div class="form-row">
                            <input type="text" class="form-input" placeholder="Your Full Name" id="home-subscriber-name">
                            <input type="email" class="form-input" placeholder="Your Email Address" id="home-subscriber-email">
                        </div>
                        <button class="subscribe-btn" id="subscribe-button">Subscribe Now</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- stories highlighlite -->
    <section id="stories" class="section stories-section">
        <div class="container">
            <h2 class="section-title">NGO Success Stories</h2>
            
            <div class="stories-filters">
                <button class="filter-btn active" data-filter="all">All Stories</button>
                <button class="filter-btn" data-filter="health">Health & WASH</button>
                <button class="filter-btn" data-filter="agriculture">Agriculture</button>
                <button class="filter-btn" data-filter="education">Education</button>
                <button class="filter-btn" data-filter="livelihoods">Livelihoods</button>
            </div>
            
            <div class="stories-grid">
                <div class="story-card" data-category="health">
                    <img src="https://images.unsplash.com/photo-1576765974257-b414b9ea0051?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80" alt="Maternal Health" class="story-image">
                    <div class="story-content">
                        <div class="story-meta">
                            <span class="story-category">Health & WASH</span>
                            <span>May 10, 2023</span>
                        </div>
                        <h3 class="story-title">Maternal Health Program Reduces Mortality by 40%</h3>
                        <p class="story-excerpt">Partnership between Ministry of Health and NGO consortium trains midwives and equips clinics in 5 provinces.</p>
                        <div class="story-footer">
                            <span class="story-author">By Dr. Lisa Mangwana</span>
                            <div class="share-buttons">
                                <button class="share-btn" data-platform="share"><i class="fas fa-share-alt"></i></button>
                                <button class="share-btn" data-platform="facebook"><i class="fab fa-facebook-f"></i></button>
                                <button class="share-btn" data-platform="twitter"><i class="fab fa-twitter"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="story-card" data-category="education">
                    <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80" alt="School Children" class="story-image">
                    <div class="story-content">
                        <div class="story-meta">
                            <span class="story-category">Education</span>
                            <span>May 8, 2023</span>
                        </div>
                        <h3 class="story-title">Digital Learning Reaches 10,000 Rural Students</h3>
                        <p class="story-excerpt">Save the Children's tablet-based learning program bridges the education gap in remote communities.</p>
                        <div class="story-footer">
                            <span class="story-author">By Farai Chikwava</span>
                            <div class="share-buttons">
                                <button class="share-btn" data-platform="share"><i class="fas fa-share-alt"></i></button>
                                <button class="share-btn" data-platform="facebook"><i class="fab fa-facebook-f"></i></button>
                                <button class="share-btn" data-platform="twitter"><i class="fab fa-twitter"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <a href="{% url 'stories_page' %}" class="read-more-btn">
                    <i class="fas fa-book-open"></i> More Stories
                </a>
            </div>
        </div>
    </section>

    <!-- 7. Vacancies Section -->
    <section id="vacancies" class="section">
        <div class="container">
            <h2 class="section-title">NGO Job Vacancies</h2>
            
            <div class="stories-filters">
                <button class="filter-btn active" data-filter="all">All Vacancies</button>
                <button class="filter-btn" data-filter="programme">Programme</button>
                <button class="filter-btn" data-filter="finance">Finance</button>
                <button class="filter-btn" data-filter="monitoring">M&E</button>
                <button class="filter-btn" data-filter="management">Management</button>
            </div>
            
            <div class="vacancies-grid">
                <div class="vacancy-card" data-category="programme">
                    <h3 class="vacancy-title">Programme Manager - Health</h3>
                    <span class="vacancy-organization">Health Innovation Trust Zimbabwe</span>
                    <div class="vacancy-details">
                        <div class="vacancy-detail">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Harare, with travel</span>
                        </div>
                        <div class="vacancy-detail">
                            <i class="fas fa-clock"></i>
                            <span>Full-time</span>
                        </div>
                        <div class="vacancy-detail">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>Competitive NGO Package</span>
                        </div>
                    </div>
                    <p class="vacancy-description">Lead the implementation of health programmes across 3 provinces, manage partnerships with Ministry of Health.</p>
                    <div class="story-footer">
                        <span>Deadline: 30 May 2023</span>
                        <div class="share-buttons">
                            <button class="share-btn" data-platform="share"><i class="fas fa-share-alt"></i></button>
                            <button class="share-btn" data-platform="linkedin"><i class="fab fa-linkedin-in"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="read-more-btn" onclick="scrollToSection('detailedVacancyPage')">
                    <i class="fas fa-briefcase"></i> View Full Job Details
                </button>
            </div>
        </div>
    </section>


    <!-- 9. Notices Section -->
    <section id="notices" class="section notices-section">
        <div class="container">
            <h2 class="section-title">Important Notices & Updates</h2>
            
            <div class="stories-filters">
                <button class="filter-btn active" data-filter="all">All Notices</button>
                <button class="filter-btn" data-filter="funding">Funding Opportunities</button>
                <button class="filter-btn" data-filter="events">Events & Workshops</button>
                <button class="filter-btn" data-filter="policy">Policy Updates</button>
                <button class="filter-btn" data-filter="reports">Reports & Publications</button>
            </div>
            
            <div class="notices-grid">
                <div class="notice-card" data-category="funding">
                    <span class="notice-date">Deadline: 15 June 2023</span>
                    <h3 class="notice-title">EU Call for Proposals: Climate Resilience in Rural Communities</h3>
                    <p class="notice-content">The European Union has announced a â‚¬5 million funding window for NGOs working on climate adaptation and resilience building in Zimbabwe's rural communities.</p>
                    <div class="story-footer">
                        <span>Category: Funding Opportunity</span>
                        <div class="share-buttons">
                            <button class="share-btn" data-platform="share"><i class="fas fa-share-alt"></i></button>
                            <button class="share-btn" data-platform="email"><i class="fas fa-envelope"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="read-more-btn" onclick="scrollToSection('detailedNoticePage')">
                    <i class="fas fa-file-alt"></i> View Full Notice Details
                </button>
            </div>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        $(document).ready(function() {
            $('#subscribe-button').on('click', function(e) {
                var name = document.getElementById('home-subscriber-name').value
                var email = document.getElementById('home-subscriber-email').value

                var errors = ""

                if(name == ""){
                    errors = "Please enter your name"
                }else if(email == ""){
                    errors = "Please enter a valid email"
                }

                if(errors == ""){
                    let loadingAlert = Swal.fire({
                        title: 'Loading...',
                        text: 'Please wait',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });
                    $.ajax({
                        url: '{% url "subscribe" %}',
                        method: 'POST',
                        dataType: 'json',
                        data: {
                            'name': name,
                            'email': email,
                        },
                        headers: {
                            'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()
                        },
                        success: function(responseData) {
                            loadingAlert.close()
                            window.location.href = '{% url "subscription_result_page" %}'
                            
                        },
                        error: function(jqXHR) {
                            Swal.fire({
                                title: 'Error',
                                text: jqXHR.responseJSON?.error || 'Server error. Try again',
                                icon: 'error'
                            });
                        },
                        complete: function(){
                            //pass
                        }
                    });
                }else{
                    Swal.fire({
                        title: 'Error',
                        text: errors,
                        icon: 'error'
                    });
                }
            });
        })

    </script>

    {% include 'partials/footer.html' %}
{% endblock %}

