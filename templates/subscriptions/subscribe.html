{% extends 'partials/base.html' %}
{% load static %}

{% block title %}NGO News Digest - Home{% endblock %}
{% block content %}
    {% csrf_token %}
    {% include 'partials/header.html' %}
    <section id="home" class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1 class="hero-title">Amplifying <span>Civil Society Impact</span> in Zimbabwe</h1>
                <p class="hero-description">NGO News Digest is dedicated to sharing, amplifying, and celebrating the work of non-governmental organisations across Zimbabwe. We document grassroots impact, showcase development innovation, and connect stakeholders through impactful storytelling.</p>
                
                <div class="hero-subscribe">
                    <h3>Subscribe to Our Newsletter</h3>
                    <div class="subscribe-form" id="heroSubscribeForm">
                        <div class="form-row">
                            <input type="text" class="form-input" placeholder="Your Full Name" id="subscriber-name">
                            <input type="email" class="form-input" placeholder="Your Email Address" id="subscriber-email">
                        </div>
                        <button class="subscribe-btn" id="subscribe-button">Subscribe Now</button>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <script src="{% static '' %}jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#subscribe-button').on('click', function(e) {
                var name = document.getElementById('subscriber-name').value
                var email = document.getElementById('subscriber-email').value

                var errors = ""

                if(name == ""){
                    errors = "Please enter your name"
                }else if(email == ""){
                    errors = "Please enter a valid email"
                }

                if(errors == ""){
                    $.ajax({
                        url: '{% url "subscribe" %}',
                        method: 'POST',
                        dataType: 'json',
                        data: {
                            'name': name,
                            'email': email,
                        },
                        headers: {
                            'X-CSRFToken': $('input[name="csrfmiddlewaretoken"]').val()
                        },
                        success: function(responseData) {
                            Swal.fire({
                                title: responseData.title,
                                text: responseData.message,
                                icon: responseData.icon,
                                timer: 1500,
                            })
                            
                        },
                        error: function(jqXHR) {
                            Swal.fire({
                                title: 'Error',
                                text: jqXHR.responseJSON?.error || 'Server error. Try again',
                                icon: 'error'
                            });
                        },
                        complete: function(){
                            //pass
                        }
                    });
                }else{
                    Swal.fire({
                        title: 'Error',
                        text: errors,
                        icon: 'error'
                    });
                }
            });
        })

    </script>
    {% include 'partials/footer.html' %}
{% endblock %}

